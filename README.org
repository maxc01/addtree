#+TITLE: AddTree Covariance Function


* dependencies

This project depends on george, numpy and scipy. george must be compiled manually.
   #+begin_src sh
git clone https://github.com/maxc01/george
cd george
python setup.py install
   #+end_src

If you are using [[https://python-poetry.org/][poetry]] to manage dependencies, the following commands will
install all dependencies and this project:
#+begin_src sh
git clone https://github.com/maxc01/addtree
cd addtree
poetry install
#+end_src
Otherwise, you will have to install these dependencies manually. Section
=[tool.poetry.dependencies]= in =pyproject.toml= lists all dependencies and
their versions.


* examples

** synthetic function (from Jenatton2017)
   #+begin_src sh
cd examples
python addtree_jenatton_small.py
   #+end_src
log files will be located in
=exp_results/addtree/jenatton-small/a-unique-dir=. The following figure shows
comparison of different algorithms on optimizaing the synthetic function.
[[./assets/synthetic-function.png]]

** model compression

    #+begin_src sh
cd examples
python {{ algo }}_model_compression_multiple.py {{ model_name }} OUTPUT_PATH --pretrained PRETRAINED_PATH --prune_epochs 1
    #+end_src
=model_name= can be "vgg16", "resnet50" or "resnet56".
=algo= can be "addtree", "random" , "tpe" or "smac".

For example, to compress resnet50 using =addtree=,
#+begin_src sh
python addtree_model_compression_multiple.py resnet50 OUTPUT_PATH --pretrained PRETRAINED_PATH --prune_epochs 1
#+end_src

The following picture shows comparison of different algorithms on compressing resnet50.
[[./assets/resnet50-cummax-median-95ci.png]]


* citation
#+begin_src bibtex
@inproceedings{ma2020,
  title = {Additive {{Tree}}-{{Structured Covariance Function}} for {{Conditional Parameter Spaces}} in {{Bayesian Optimization}}},
  booktitle = {International {{Conference}} on {{Artificial Intelligence}} and {{Statistics}}},
  author = {Ma, Xingchen and Blaschko, Matthew},
  year = {2020},
  month = jun,
  pages = {1015--1025},
  publisher = {{PMLR}},
  issn = {2640-3498},
  language = {en}
}

@article{ma2020b,
  title = {Additive Tree-Structured Conditional Parameter Spaces in Bayesian Optimization: {{A}} Novel Covariance Function and a Fast Implementation},
  author = {Ma, X. and Blaschko, M. B.},
  year = {2020},
  publisher = {{IEEE Computer Society}},
  address = {{Los Alamitos, CA, USA}},
  issn = {1939-3539},
  doi = {10.1109/TPAMI.2020.3026019},
  journal = {IEEE Transactions on Pattern Analysis \& Machine Intelligence},
  keywords = {additives,bayes methods,data models,linear programming,mathematical model,neural networks,optimization}
}
#+end_src
